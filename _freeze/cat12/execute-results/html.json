{
  "hash": "d6a6ca38d426824f2ebaa5ae0c9cb935",
  "result": {
    "engine": "knitr",
    "markdown": "---\nformat:\n  html:\n    df-print: tibble\n---\n\n\n\n\n\n# Voxel-Based Morphometry {#sec-cat12}\n\nThis starter kit walk through the voxel-based morphometry outputs generated by the [Computational Anatomy Toolbox (CAT12)](https://neuro-jena.github.io/cat/). The kit relies on `bash` and `R`. \n\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nlibrary(readr)\nlibrary(ggplot2)\nlibrary(dplyr)\n```\n:::\n\n\n\n\n\n\n## Before Proposing Project\n\n### Confirm Sample Size\n\nNot all participants in a release have imaging, and not all MRIs are of good quality. Before proposing a project, please confirm that a release will have a large enough sample size. Release 2.0.0 has 1017 participants with for which CAT12 been run. \n\n## Starting Project\n\n### Locate data\n\n\nOn TACC, the neuroimaging data are stored underneath the releases. For example, data release v2.#.# is underneath\n\n```bash\npre-surgery/mris\n```\n\n\n\nThe morphometry measures are underneath `derivatives/cat12`.\n\n### Extract data\n\nData for each participant is stored in a sub-directory\n\n```bash\n$ ls -d derivatives/cat12/sub* | head\nderivatives/cat12/sub-10003\nderivatives/cat12/sub-10005\nderivatives/cat12/sub-10008\nderivatives/cat12/sub-10009\nderivatives/cat12/sub-10010\nderivatives/cat12/sub-10011\nderivatives/cat12/sub-10013\nderivatives/cat12/sub-10014\nderivatives/cat12/sub-10015\nderivatives/cat12/sub-10017\n```\n\nFor example:\n\n```bash\n$ tree derivatives/cat12/sub-10003\nderivatives/cat12/sub-10003\n└── ses-V1\n    ├── label\n    │   ├── catROI_sub-10003_ses-V1_T1w.mat\n    │   └── catROI_sub-10003_ses-V1_T1w.xml\n    ├── mri\n    │   ├── misub-10003_ses-V1_T1w.nii\n    │   ├── msub-10003_ses-V1_T1w.nii\n    │   ├── mwp1sub-10003_ses-V1_T1w.nii\n    │   ├── mwp2sub-10003_ses-V1_T1w.nii\n    │   ├── mwp3sub-10003_ses-V1_T1w.nii\n    │   ├── p0sub-10003_ses-V1_T1w.nii\n    │   ├── p1sub-10003_ses-V1_T1w.nii\n    │   ├── p2sub-10003_ses-V1_T1w.nii\n    │   ├── p3sub-10003_ses-V1_T1w.nii\n    │   ├── wmisub-10003_ses-V1_T1w.nii\n    │   ├── wmsub-10003_ses-V1_T1w.nii\n    │   ├── wp0sub-10003_ses-V1_T1w.nii\n    │   ├── wp1sub-10003_ses-V1_T1w.nii\n    │   ├── wp2sub-10003_ses-V1_T1w.nii\n    │   ├── wp3sub-10003_ses-V1_T1w.nii\n    │   └── y_sub-10003_ses-V1_T1w.nii\n    ├── report\n    │   ├── catlog_sub-10003_ses-V1_T1w.txt\n    │   ├── cat_sub-10003_ses-V1_T1w.mat\n    │   └── cat_sub-10003_ses-V1_T1w.xml\n    └── surf\n        ├── lh.central.sub-10003_ses-V1_T1w.gii\n        ├── lh.pbt.sub-10003_ses-V1_T1w\n        ├── lh.pial.sub-10003_ses-V1_T1w.gii\n        ├── lh.sphere.reg.sub-10003_ses-V1_T1w.gii\n        ├── lh.sphere.sub-10003_ses-V1_T1w.gii\n        ├── lh.thickness.sub-10003_ses-V1_T1w\n        ├── lh.white.sub-10003_ses-V1_T1w.gii\n        ├── rh.central.sub-10003_ses-V1_T1w.gii\n        ├── rh.pbt.sub-10003_ses-V1_T1w\n        ├── rh.pial.sub-10003_ses-V1_T1w.gii\n        ├── rh.sphere.reg.sub-10003_ses-V1_T1w.gii\n        ├── rh.sphere.sub-10003_ses-V1_T1w.gii\n        ├── rh.thickness.sub-10003_ses-V1_T1w\n        └── rh.white.sub-10003_ses-V1_T1w.gii\n\n5 directories, 35 files\n```\n\nAdditionally, there is a table of \"cluster volumes\", which contains information relevant to A2CPS primary and secondary biomarkers.\n\n```bash\n$ ls derivatives/cat12/cluster*\nderivatives/cat12/cluster_volumes.json  derivatives/cat12/cluster_volumes.tsv\n\n$ head derivatives/cat12/cluster_volumes.tsv \nsub\tses\tmri\tatlas\tcluster\tvolume\n10703\tV1\twp1sub-10703_ses-V1_T1w\ttpl-MNI152NLin2009cAsym_atlas-smallwood_dseg\t0\t1998.106000518892\n10703\tV1\twp1sub-10703_ses-V1_T1w\ttpl-MNI152NLin2009cAsym_atlas-smallwood_dseg\t1\t2294.6824886463583\n10703\tV1\tmwp1sub-10703_ses-V1_T1w\ttpl-MNI152NLin2009cAsym_atlas-smallwood_dseg\t0\t1219.69091796875\n10703\tV1\tmwp1sub-10703_ses-V1_T1w\ttpl-MNI152NLin2009cAsym_atlas-smallwood_dseg\t1\t1443.6837158203125\n10753\tV1\tmwp1sub-10753_ses-V1_T1w\ttpl-MNI152NLin2009cAsym_atlas-smallwood_dseg\t0\t1673.0926513671875\n10753\tV1\tmwp1sub-10753_ses-V1_T1w\ttpl-MNI152NLin2009cAsym_atlas-smallwood_dseg\t1\t1950.593505859375\n10753\tV1\twp1sub-10753_ses-V1_T1w\ttpl-MNI152NLin2009cAsym_atlas-smallwood_dseg\t0\t2353.910433325509\n10753\tV1\twp1sub-10753_ses-V1_T1w\ttpl-MNI152NLin2009cAsym_atlas-smallwood_dseg\t1\t2952.608998143696\n10040\tV1\tmwp1sub-10040_ses-V1_T1w\ttpl-MNI152NLin2009cAsym_atlas-smallwood_dseg\t0\t1499.8414306640625\n```\n\nThe `json` file contains a data dictionary, with links to confluence pages providing detailed information about each of the atlases.\n\n```json\n{\n    \"sub\": {\n        \"LongName\": \"Subject\",\n        \"Description\": \"Study Participant, BIDS Subject ID\",\n        \"TermURL\": \"https://bids-specification.readthedocs.io/en/v1.9.0/appendices/entities.html#sub\"\n    },\n    \"ses\": {\n        \"LongName\": \"Session\",\n        \"Description\": \"Visit, Protocol, BIDS Session ID\",\n        \"Levels\": {\n            \"V1\": \"baseline_visit\",\n            \"V3\": \"3mo_postop\"\n        },\n        \"TermURL\": \"https://bids-specification.readthedocs.io/en/v1.9.0/appendices/entities.html#ses\"\n    },\n    \"mri\": {\n        \"LongName\": \"MRI Filename\",\n        \"Description\": \"Product of CAT12 in which volumes were calculated\",\n        \"TermURL\": \"https://neuro-jena.github.io/cat12-help/#naming\"\n    },\n    \"atlas\": {\n        \"LongName\": \"Atlas of Clusters\",\n        \"Description\": \"Source file in which clusters are defined\",\n        \"Levels\": {\n            \"tpl-MNI152NLin2009cAsym_atlas-smallwood_dseg\": \"https://a2cps.atlassian.net/wiki/spaces/DOC/pages/5406884/Smallwood+et+al.+2013+Materials\",\n            \"tpl-MNI152NLin2009cAsym_atlas-henn_desc-controlspatientgmtfce05_dseg\": \"https://doi.org/10.1097/j.pain.0000000000002681, Table 4\"\n        }\n    },\n    \"cluster\": {\n        \"LongName\": \"Cluster Number\",\n        \"Description\": \"ID of cluster as reported by FSL. May not match ID in source paper.\"\n    },\n    \"volume\": {\n        \"LongName\": \"Cluster Volume\",\n        \"Description\": \"Volume of cluster_id from atlas_id in mri_id calculated as number of voxels times voxel volume.\"\n    }\n}\n```\n\n## Considerations While Working on the Project\n\n### Variability Across Scanners\n\n\nMany MRI biomarkers exhibit variability across the scanners, which may confound some analyses. The imaging DIRC is quantifying and mitigating this variability. For an ongoing review of the issue, please see [Confluence](https://a2cps.atlassian.net/wiki/spaces/DOC/pages/176619539/Imaging+Harmonization). \n\n\n\n### Data Quality\n\n\nAs with any MRI derivative, all pipeline derivatives have been included. This means that products were included regardless of their quality, and so some products may have been generated from images that are known to have poor quality--rated \"red\" or incomparable. For details on the ratings and how to exclude them, see @sec-rawdata-mri-qc-joining. Additionally, extensive QC has not yet been performed on the derivatives themselves, and so there may be cases where pipelines produced atypical outputs. For an overview of planned checks, see [Confluence](https://a2cps.atlassian.net/wiki/spaces/DOC/pages/262471688/Image+Processing+Checks). \n\n\n\n### CAT12 Configuration\n\nFor details on CAT12's methods see [their documentation](https://neuro-jena.github.io/cat12-help/#major_process). CAT12 ([12.9](https://github.com/ChristianGaser/cat12/releases/tag/12.9), r2582) was run with nearly the default configurations, changing only parameters that cause a few additional outputs to be saved. For the full batch script, see [GitHub](https://github.com/a2cps/biomarker-extractor/blob/86809551c856ff468bafeb631858a7939b53bfe9/src/biomarkers/data/batch.m). \n\n### CAT12 Image Quality Ratings\n\nPart of the Raw MRI data quality ratings are derived from an \"Image Quality Rating\" that is provided by CAT12. The ratings were pulled from the xml document in the `reports` subfolder. For example\n\n```bash\n$ grep -P \"<IQR>|\\(IQR\\)\" sub-10003/ses-V1/report/cat_sub-10003_ses-V1_T1w.xml\n      <IQR>1.85445149536238</IQR>\n      <item>Image Quality Rating (IQR): 86.46% (B)</item>\n```\n\nThe version of the IQR reported as a percentage is equal to $105 - 10*IQR$.\n\nNote that CAT12 typically generates a PDF with an overview of processing and image quality. There is an ongoing issue with CAT12 that prevented the PDFs from being generated for Release 2.0.0. For details, see [the associated issue on the CAT12 GitHub Repo](https://github.com/ChristianGaser/cat12/issues/27). \n\n",
    "supporting": [],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {},
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}